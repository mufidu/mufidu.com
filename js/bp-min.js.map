{"version":3,"file":"bp-min.js","sources":["../src/bp.js"],"sourcesContent":["(function (window, apiHost) {\r\n  if (window.beampipe) {\r\n    return;\r\n  }\r\n  var location = window.location;\r\n  var document = window.document;\r\n  var history = window.history;\r\n  var isLocal =\r\n    /^localhost$|^127(?:\\.[0-9]+){0,2}\\.[0-9]+$|^(?:0*\\:)*?:?0*1$/.test(\r\n      location.hostname\r\n    ) || location.protocol === \"file:\";\r\n  var ele =\r\n    document.querySelector(\"[data-beampipe-domain]\") ||\r\n    document.querySelector(\"[data-alysis-domain]\");\r\n  var domain =\r\n    ele.getAttribute(\"data-beampipe-domain\") ||\r\n    ele.getAttribute(\"data-alysis-domain\") ||\r\n    (isLocal ? \"localhost\" : location.host);\r\n  var track = function (event) {\r\n    var _a;\r\n    if (isLocal) {\r\n      console.warn(\"Ignoring in local mode\");\r\n      return;\r\n    }\r\n    var payload = {\r\n      type: event,\r\n      url:\r\n        location.protocol +\r\n        \"//\" +\r\n        location.hostname +\r\n        location.pathname +\r\n        location.search,\r\n      domain: domain,\r\n      referrer: document.referrer,\r\n      userAgent: window.navigator.userAgent,\r\n      source:\r\n        (_a = location.search.match(/[?&](ref|source|utm_source)=([^?&]+)/)) ===\r\n          null || _a === void 0\r\n          ? void 0\r\n          : _a[2],\r\n      screenWidth: window.innerWidth,\r\n    };\r\n    var request = new XMLHttpRequest();\r\n    request.open(\"POST\", apiHost, true);\r\n    request.setRequestHeader(\"Content-Type\", \"application/json\");\r\n    request.send(JSON.stringify(payload));\r\n  };\r\n  var log = function () {\r\n    return track(\"page_view\");\r\n  };\r\n  window.beampipe = track;\r\n  if (history.pushState) {\r\n    var pushState_1 = history[\"pushState\"];\r\n    history.pushState = function () {\r\n      pushState_1.apply(this, arguments);\r\n      log();\r\n    };\r\n    window.addEventListener(\"popstate\", log);\r\n  }\r\n  log();\r\n})(window, \"https://beampipe.io/event\");\r\n"],"names":["window","apiHost","beampipe","location","document","history","isLocal","test","hostname","protocol","ele","querySelector","domain","getAttribute","host","track","event","_a","console","warn","payload","type","url","pathname","search","referrer","userAgent","navigator","source","match","screenWidth","innerWidth","request","XMLHttpRequest","open","setRequestHeader","send","JSON","stringify","log","pushState","pushState_1","apply","this","arguments","addEventListener"],"mappings":"0BAAA,SAAWA,EAAQC,GACjB,IAAID,EAAOE,SAAX,CAGA,IAAIC,EAAWH,EAAOG,SAClBC,EAAWJ,EAAOI,SAClBC,EAAUL,EAAOK,QACjBC,EACF,+DAA+DC,KAC7DJ,EAASK,WACgB,UAAtBL,EAASM,SACZC,EACFN,EAASO,cAAc,2BACvBP,EAASO,cAAc,wBACrBC,EACFF,EAAIG,aAAa,yBACjBH,EAAIG,aAAa,wBAChBP,EAAU,YAAcH,EAASW,MAChCC,EAAQ,SAAUC,GACpB,IAAIC,EACJ,GAAIX,EACFY,QAAQC,KAAK,8BADf,CAIA,IAAIC,EAAU,CACZC,KAAML,EACNM,IACEnB,EAASM,SACT,KACAN,EAASK,SACTL,EAASoB,SACTpB,EAASqB,OACXZ,OAAQA,EACRa,SAAUrB,EAASqB,SACnBC,UAAW1B,EAAO2B,UAAUD,UAC5BE,OAEI,QADDX,EAAKd,EAASqB,OAAOK,MAAM,+CACX,IAAPZ,OACN,EACAA,EAAG,GACTa,YAAa9B,EAAO+B,YAElBC,EAAU,IAAIC,eAClBD,EAAQE,KAAK,OAiBN,6BAjBuB,GAC9BF,EAAQG,iBAAiB,eAAgB,oBACzCH,EAAQI,KAAKC,KAAKC,UAAUlB,MAE1BmB,EAAM,WACR,OAAOxB,EAAM,cAGf,GADAf,EAAOE,SAAWa,EACdV,EAAQmC,UAAW,CACrB,IAAIC,EAAcpC,EAAmB,UACrCA,EAAQmC,UAAY,WAClBC,EAAYC,MAAMC,KAAMC,WACxBL,KAEFvC,EAAO6C,iBAAiB,WAAYN,GAEtCA,KA3DF,CA4DGvC"}